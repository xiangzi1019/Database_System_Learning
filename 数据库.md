#数据库系统
以关系数据库为基础介绍：

- 基本关系与模型
- 数据库语言
- 数据建模与数据库设计
- 数据库管理系统的实现

------------
特点：

- 抽象
- 思维
- 应用
- 管理
- 案例

##第一讲 初步认识数据库
现在社会处于大数据时代，了解数据以及数据库来给予以往的数据来预测和分析接下来的发展。

即：数据累积变成数据库，数据库的汇集成为大数据，分析和应用造福相应人。

**Table：表**  按行按列的形式数据。

**Database：数据库** 相关之间有关系的Table的集合。

-------------

**数据库管理系统：DBMS**  

- *数据库定义* 数据库中Table的名称、标题等。
- *数据库操作* 向数据库额Table中增加、删除、更新以及进行查询、检索的操作。
- *数据库控制* 控制数据库中数据的使用---哪些用户可以使用，哪些不可以。
- *数据库维护*  转储、恢复、重组、性能检测、分析等。

--------------

**数据库语言：**

- 数据库定义语言： DDL,Data Definition Langelage
                 DBMS提供给用户，以便于用户定义数据格式
- 数据库操作语言： DML,Data Manipulation Langelage
                 DBMS提供给用户，以便于用户对数据的操作
- 数据库控制语言： DCL,Data Control Langelage
                 DBMS提供给用户，以便于用户对数据进行控制
- 数据库各种操作的执行

以上综述为：SQl语言

**交互式数据库语言：**

- SELECT
- FROM
- WHERE

**嵌入式数据库语言：**可以很方便的嵌入到各类编程语言中操作数据库。

----------

#第二讲 数据库系统的结构抽象与演变

##数据库的标准结构
###1）数据库系统的分层抽象
DBMS管理数据分为三个层次：

- 外部层次=用户层次：指只让用户看到的数据的一部分
- 概念层次=逻辑层次：全局角度理解管理数据，还有一些约束
- 内部层次=物理层次：存储在介质上的数据，含有存储的路径、方式以及索引的方式。
###2）两个模式
数据（视图）与模式：

- **模式：** 对数据库中数据进行的一种结构性的描述
- **视图/数据:** 某一种形式下表现出来的数据库中的数据

三级模式：

- **内模式：**存储在介质上的数据的结构描述，喊存储路径，存储方法，索引方法等。
- **概念模式=存储模式：**从全局角度理解、管理数据的结构描述，含有相应的关联约束。
- **外模式=用户模式：**用户能够看到和处理的数据的结构描述。

两层映像：

- **E-C映像：** 外模式映射为概念模式，便于用户观察和使用
- **C-I映像：** 概念模式映射为内模式，便于计算机进行存储和处理。

###3）数据模型
什么是数据模型：

规定模式统一描述方式的模型，包括：数据结构、操作和约束。

数据模式：是对模式本身结构的抽象。
模式：是对数据本身结构形式的抽象。

比如：关系模式，所有模式可抽象为表（Table）的形式【数据结构】，而每一个具体的模式都是拥有不同列名的具体的表。是对这种表形式的数据有哪些【操作】和【约束】。

例如:学生登记表是一个模式A，学生成绩单是模式B，两者综合起来就是关系模型。

------------
三大经典数据模型：

- 关系模型：表的形式组织数据
- 层次模型：树的形式组织数据
- 网状模型：图的形式组织数据

---------
数据库的发展阶段：

不做详细介绍！学习时候去百度，当做小说看即可。

##关系模型
什么是关系模型呢？

形象的说关系就是一个Table。

###关系模型的三个要素：
- **基本关系：** Relation/Table
- **基本操作：** 五个基本操作：并，差，选择，投影，广义积。扩展：交，连接，除。
- **完整性约束：** 实体完整性，参照完整性以及用户自定义完整性。

**关系代数和关系运算**

基于数学语言转换成计算机的语言。
###什么是关系？
- **表的严格定义：**

>> 列的取值范围“域”，成为值得集合，具有相同的数据类型，且集合中元素的个数称为域的“基数”

>> 再定义元组（tuple）以及所有可能组合的元组：笛卡尔积

- **关系：** 一组与的笛卡尔积的子集。
>>笛卡尔积中的具有某一方面意义的那些元组被称为一个关系。
###关系模式与关系
- 同一模式下，可有很多的关系
- 关系模式是关系的结构，关系是关系模式在某一时刻的数据
- 关系模式是稳定的，而关系是某一时刻的值，是随时间可能变化的
###关系的特性
- **列是同性质的：**即每一列的分量来自同一域，是同一类型的数据
- **不同的列可以来自同一域：**其中每一列为一个属性，不同的属性要给予不同的属性名。
- **关系与行列的位置无关**
- **理论上，关系的任意两个元组不能完全一样** 但实际上表不一定准守。
- **属性不可再分：** 关系第一范式
###关系的概念
**候选码/候选键** 关系中一个属性组，其值能唯一表示一个元组，若从该元组中去掉一个属性，他就不具备这个属性了，这样的属性组成为“候选码”

例如学校中的学生的学号可以唯一标识。

有时，关系中可能有很多个候选码。

因此我们要选择一个作为：**主码（Primary Key）/主键**

另一个概念：**外码（Foreign）/外键:**关系R中的一个属性组，他不是R的候选码，，但它与另一个关系S的候选码相对应，我们就成此为外码（Foreign）/外键。

*外码* 是连接两个或者多个关系的纽带。
###关系模型中的完整性
- 实体完整性： 1.关系的主码中的属性值不能为空。2.空值：不知道或者不存在没有意义的值。关系模型中用‘？’来标识空值。一般性用默认值作为空值。 
- 参照完整性：外码要保证两个表之间连接的正确性。不能出现非相关值。
- 用户自定义完整性：在很多的环境中，用户针对具体的环境定义完整性约束。

##关系模型之关系代数
关系代数的特点：

基于集合，提供了一些列的关系代数操作：并，差，笛卡尔积，选择，投影和更名的基本操作。这是一个抽象语言，是学习其他语言的基础。
###一般操作
- **并（Union）**就是离散数学中的集合论部分相同的概念。例如A={1,2,3}，B={2,3,4}，A∪B={1,2,3,4}
- **差（Difference）** 同理。R-S就是t∈R,但t∉S。例如A={1,2,3}，B={2,3,4}，A-B={1}，再例如R为计算机院的学生，S为大一的学生。R-S为计算机学院不是大一的学生。S-R为大一并不是计算机学院的学生。
- **广义笛卡尔积** 就是叉乘的结果。例如A中有m个关系，B中有n个关系。AxB的结果就是m*n的所有可能的组合。
- **选择（Select）** 给定一个关系R，同事给定一个选择的条件condition选择运算的结果也就是一个关系。
- **投影操作（Project）** 给分ing一个关系R，投影运算的结果也是一个关系。他从已知的关系中选出属性包含需要的A中的列构成。这个是对列的操作，而选择关系是对于行的操作。
###扩展操作
- **交（Intersection）**与离散数学标书一样，就是R∩S={t|t∈R^t∈S}，并且可以用差运算表示：R∩S=R-(R-S)=S-(S-R)；例如A={1,2,3}，B={2,3,4}，A∩B={2,3}
- **连接（θ-join）** 如同乘积操作，但是不同点在于按照给定的条件筛选出相应的元组。其实DBMS可以直接进行连接操作，不需要我们这样的中间步骤。
- **等值连接（Equi-join)** 就是连接的变种，当值相同时候做连接。***经常使用***
- **自然连接（Natural-join）** 一种特殊的等值连接，属性名相同属性名相等时候作连接，并且去掉一组相同的属性。就是最自然的两个表的连接。保证一列或者多列相同就好。***使用最普遍***

**接下来就是做一些题目强化一下**
###复杂扩展操作
- **除（Division）** R÷S结果为R中的存在S的属性且元素去掉。
- **外连接（Outer-join）** 作为失配操作的相对做法。对于没有相匹配元组，与空元组匹配保存。写作：外连接=自然连接+失配的元组。且外连接可分为左外连接，右外连接，全外连接。

-------------

##SQL的讲解
SQL讲解给予MySQL应用。

    1.什么是SQL？
		Structured Query Language：结构化查询语言
		其实就是定义了操作所有关系型数据库的规则。每一种数据库操作的方式存在不一样的地方，称为“方言”。
		
	2.SQL通用语法
		1. SQL 语句可以单行或多行书写，以分号结尾。
		2. 可使用空格和缩进来增强语句的可读性。
		3. MySQL 数据库的 SQL 语句不区分大小写，关键字建议使用大写。
		4. 3 种注释
			* 单行注释: -- 注释内容 或 # 注释内容(mysql 特有) 
			* 多行注释: /* 注释 */
		* * MySQL登录
			1. mysql -uroot -p密码
			2. mysql -hip -uroot -p连接目标的密码
			3. mysql --host=ip --user=root --password=连接目标的密码
		* MySQL退出
			1. exit
			2. quit
    3. SQL分类
		1) DDL(Data Definition Language)数据定义语言
			用来定义数据库对象：数据库，表，列等。关键字：create, drop,alter 等
		2) DML(Data Manipulation Language)数据操作语言
			用来对数据库中表的数据进行增删改。关键字：insert, delete, update 等
		3) DQL(Data Query Language)数据查询语言
			用来查询数据库中表的记录(数据)。关键字：select, where 等
		4) DCL(Data Control Language)数据控制语言(了解)
			用来定义数据库的访问权限和安全级别，及创建用户。关键字：GRANT， REVOKE 等

###DDL：操作数据库表
    1.操作数据库：CRUD
        1. C(Create):创建
			* 创建数据库：
				* create database 数据库名称;
			* 创建数据库，判断不存在，再创建：
				* create database if not exists 数据库名称;
			* 创建数据库，并指定字符集
				* create database 数据库名称 character set 字符集名;

			* 练习： 创建db4数据库，判断是否存在，并制定字符集为gbk
				* create database if not exists db4 character set gbk;
		2. R(Retrieve)：查询
			* 查询所有数据库的名称:
				* show databases;
			* 查询某个数据库的字符集:查询某个数据库的创建语句
				* show create database 数据库名称;
		3. U(Update):修改
			* 修改数据库的字符集
				* alter database 数据库名称 character set 字符集名称;
		4. D(Delete):删除
			* 删除数据库
				* drop database 数据库名称;
			* 判断数据库存在，存在再删除
				* drop database if exists 数据库名称;
		5. 使用数据库
			* 查询当前正在使用的数据库名称
				* select database();
			* 使用数据库
				* use 数据库名称;


    2. 操作表
		1. C(Create):创建
			1. 语法：
				create table 表名(
					列名1 数据类型1,
					列名2 数据类型2,
					....
					列名n 数据类型n
				);
				* 注意：最后一列，不需要加逗号（,）
				* 数据库类型：
					1. int：整数类型
						* age int,
					2. double:小数类型
						* score double(5,2)
					3. date:日期，只包含年月日，yyyy-MM-dd
					4. datetime:日期，包含年月日时分秒	 yyyy-MM-dd HH:mm:ss
					5. timestamp:时间错类型	包含年月日时分秒	 yyyy-MM-dd HH:mm:ss	
						* 如果将来不给这个字段赋值，或赋值为null，则默认使用当前的系统时间，来自动赋值

					6. varchar：字符串
						* name varchar(20):姓名最大20个字符
						* zhangsan 8个字符  张三 2个字符
				

			* 创建表
				create table student(
					id int,
					name varchar(32),
					age int ,
					score double(4,1),
					birthday date,
					insert_time timestamp
				);
			* 复制表：
				* create table 表名 like 被复制的表名;	  	
		2. R(Retrieve)：查询
			* 查询某个数据库中所有的表名称
				* show tables;
			* 查询表结构
				* desc 表名;
		3. U(Update):修改
			1. 修改表名
				alter table 表名 rename to 新的表名;
			2. 修改表的字符集
				alter table 表名 character set 字符集名称;
			3. 添加一列
				alter table 表名 add 列名 数据类型;
			4. 修改列名称 类型
				alter table 表名 change 列名 新列别 新数据类型;
				alter table 表名 modify 列名 新数据类型;
			5. 删除列
				alter table 表名 drop 列名;
		4. D(Delete):删除
			* drop table 表名;
			* drop table  if exists 表名 ;

## DML：增删改表中数据

	1. 添加数据：
		* 语法：
			* insert into 表名(列名1,列名2,...列名n) values(值1,值2,...值n);
		* 注意：
			1. 列名和值要一一对应。
			2. 如果表名后，不定义列名，则默认给所有列添加值
				insert into 表名 values(值1,值2,...值n);
			3. 除了数字类型，其他类型需要使用引号(单双都可以)引起来
	2. 删除数据：
		* 语法：
			* delete from 表名 [where 条件]
		* 注意：
			1. 如果不加条件，则删除表中所有记录。
			2. 如果要删除所有记录
				1. delete from 表名; -- 不推荐使用。有多少条记录就会执行多少次删除操作
				2. TRUNCATE TABLE 表名; -- 推荐使用，效率更高 先删除表，然后再创建一张一样的表。
	3. 修改数据：
		* 语法：
			* update 表名 set 列名1 = 值1, 列名2 = 值2,... [where 条件];

		* 注意：
			1. 如果不加任何条件，则会将表中所有记录全部修改。

## DQL：查询表中的记录
	* select * from 表名;
	
	1. 语法：
		select
			字段列表
		from
			表名列表
		where
			条件列表
		group by
			分组字段
		having
			分组之后的条件
		order by
			排序
		limit
			分页限定


	2. 基础查询
		1. 多个字段的查询
			select 字段名1，字段名2... from 表名；
			* 注意：
				* 如果查询所有字段，则可以使用*来替代字段列表。
		2. 去除重复：
			* distinct
		3. 计算列
			* 一般可以使用四则运算计算一些列的值。（一般只会进行数值型的计算）
			* ifnull(表达式1,表达式2)：null参与的运算，计算结果都为null
				* 表达式1：哪个字段需要判断是否为null
				* 如果该字段为null后的替换值。
		4. 起别名：
			* as：as也可以省略
			

	3. 条件查询
		1. where子句后跟条件
		2. 运算符
			* > 、< 、<= 、>= 、= 、<>
			* BETWEEN...AND  
			* IN( 集合) 
			* LIKE：模糊查询
				* 占位符：
					* _:单个任意字符
					* %：多个任意字符
			* IS NULL  
			* and  或 &&
			* or  或 || 
			* not  或 !
			
				-- 查询年龄大于20岁

				SELECT * FROM student WHERE age > 20;
				
				SELECT * FROM student WHERE age >= 20;
				
				-- 查询年龄等于20岁
				SELECT * FROM student WHERE age = 20;
				
				-- 查询年龄不等于20岁
				SELECT * FROM student WHERE age != 20;
				SELECT * FROM student WHERE age <> 20;
				
				-- 查询年龄大于等于20 小于等于30
				
				SELECT * FROM student WHERE age >= 20 &&  age <=30;
				SELECT * FROM student WHERE age >= 20 AND  age <=30;
				SELECT * FROM student WHERE age BETWEEN 20 AND 30;
				
				-- 查询年龄22岁，18岁，25岁的信息
				SELECT * FROM student WHERE age = 22 OR age = 18 OR age = 25
				SELECT * FROM student WHERE age IN (22,18,25);
				
				-- 查询英语成绩为null
				SELECT * FROM student WHERE english = NULL; -- 不对的。null值不能使用 = （!=） 判断
				
				SELECT * FROM student WHERE english IS NULL;
				
				-- 查询英语成绩不为null
				SELECT * FROM student WHERE english  IS NOT NULL;
	


				-- 查询姓马的有哪些？ like
				SELECT * FROM student WHERE NAME LIKE '马%';
				-- 查询姓名第二个字是化的人
				
				SELECT * FROM student WHERE NAME LIKE "_化%";
				
				-- 查询姓名是3个字的人
				SELECT * FROM student WHERE NAME LIKE '___';
				
				
				-- 查询姓名中包含德的人
				SELECT * FROM student WHERE NAME LIKE '%德%';

----------------------

##数据建模和数据库设计
###为什么要数据建模和数据库设计
研发的软件不能满足一部分需求
###数据模型和概念模型
计算机世界称为**数据模型**，信息世界的模型称为**概念模型**